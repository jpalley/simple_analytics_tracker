<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test HTML Page</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }
        h1 {
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
    </style>
    <script src="/simple_analytics.js"></script>
    
</head>
<body>
    <div class="container">
        <h1>Welcome to the Test Page</h1>
        <p>This is a basic HTML file with some test content.</p>
        <ul>
            <li>Item 1</li>
            <li>Item 2</li>
            <li>Item 3</li>
        </ul>
        <p>Feel free to modify this content as needed for your testing purposes.</p>
    </div>
    <script>
        // Wait for the DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Function to initialize VisitorLogger
            function initVisitorLogger() {
                if (typeof VisitorLogger !== 'undefined') {
                    VisitorLogger.init({
                        serverUrl: 'http://localhost:3000/',
                        enableScrollDepth: true,
                        enableEventLogging: true,
                        customParameters: ['rfid']
                    });
                    
                    // Function to check for hubspotutk cookie and identify user
                    function checkAndIdentifyUser() {
                        var hubspotutk = getCookie('hubspotutk');
                        if (hubspotutk) {
                            console.log('Identifying user with hubspotutk:', hubspotutk);
                            VisitorLogger.identify({
                                hubspotutk: hubspotutk
                            });
                            // Stop watching for the cookie once identified
                            clearInterval(cookieCheckInterval);
                        }
                    }
    
                    // Helper function to get cookie value
                    function getCookie(name) {
                        var value = "; " + document.cookie;
                        var parts = value.split("; " + name + "=");
                        if (parts.length == 2) return parts.pop().split(";").shift();
                    }
    
                    // Check immediately and then every 1 second
                    checkAndIdentifyUser();
                    var cookieCheckInterval = setInterval(checkAndIdentifyUser, 1000);
    
                } else {
                    // If VisitorLogger is not loaded yet, wait and try again
                    setTimeout(initVisitorLogger, 50);
                }
            }
    
            // Start the initialization process
            initVisitorLogger();
        });
    </script>
</body>
</html>

